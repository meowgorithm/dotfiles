#!/bin/bash

ensure() {
    if ! command -v "$1" &> /dev/null; then
        printf "$1 not found. Please install it (or check your PATH) and try again.\n"
        exit 1
    fi
}

filter() {
    tmux list-sessions -F "#S" | fzf --height 20
}

ensure tmux
ensure fzf

if ! tmux ls &> /dev/null; then
    printf "no sessions\n"
    exit 1
fi

if [ "$TMUX" != "" ]; then
    tmux switch-client -t $(filter)
else
    tmux attach-session -t $(filter)
fi
